---
title: "波形匹配算法"
sequence: "101"
---

波形匹配算法（Waveform Matching Algorithm）是一种用于信号匹配与识别的算法。
波形匹配算法，根据信号的形状、频率和振幅等特征来确定信号之间的相似性和差异性。

## 算法分类

- 波形匹配算法
    - 基于相关的算法
        - 标准互相关（CC）
        - 归一化互相关（NCC）
    - 特征提取
        - 迭代法
        - 奇异值分解法

目前，波形匹配算法，主要可以分成**基于相关的算法**和**特征提取**这两类。

特征提取的方法有很多，如迭代法、奇异值分解法等；
但不管哪种方法，特征提取都是一个比较复杂的过程，而且特征提取的好坏直接影响到匹配的性能。

相关算法，是一种采用标准波形在搜索区域中进行跟踪匹配以找到最佳的位置的方法。
有很多方法可以测量两个对象之间的相关性，
但这些方法中互相关方法，由于具有抗干扰性的健壮性的特点，是一种优先选择的算法。
常用的互相关算法有：标准互相关（CC）、归一化互相关（NCC）。
因为 NCC 对于信号强度的线性变化和噪声的影响不敏感，以及在匹配精度方法的优点，它的性能要强于 CC。
但是，这两种算法都有一个共同的缺点——计算花费高，尤其是当数据量增大的时候。

目前，一种有效的计算 NCC 的方式是先使用 FFT 计算标准的 CC，然后使用求和表进行归一化，这种方法已经被应用于故障检测。
然而，此方法依赖于选择一系列的基函数来逼近模板，由于并不能保证用最少的基函数选择出最佳的位置点，
所以选择最佳基函数集的计算量是不可忽略的。

另一种计算 NCC 的方式，是先将用于相关的两个序列减去他们的平均值，然后将这两个序列扩展成长度相同的两个序列，最后利用 FFT 和 IFFT 分别计算，
此方法由于需要先计算加减，再延拓序列的长度进行 FFT，降低了计算效率。

因为相关性的表达是基于**卷积理论**，且卷积可以在**频域**中进行高效计算。
在不改变 NCC 匹配原理的基础上，通过对 NCC 公式的变换，并利用滑动窗口和快速傅立叶变换（FFT）及反变换（IFFT）计算互相关系数，
达到了提高计算效率的目的。

## 波形匹配算法原理

**波形匹配算法，利用信号的时间序列数据，通过计算信号样本之间的距离，来判断信号的相似性。**
通常采用欧几里得距离（Euclidean distance）或曼哈顿距离（Manhattan distance）来计算样本间距离。

在波形匹配算法中，最常见的方法是使用**动态时间规整（Dynamic Time Warping, DTW）算法**。
DTW 算法，可以对两个时间序列进行相似性比较和匹配，通过对二者之间的距离和匹配路径进行计算，得到它们之间的相似度。
DTW 算法的核心思想是将不同长度的时间序列对齐，消除两个时间轴上所造成的不同步问题。
通过对相同时间点上的采样值进行匹配，来确定时间序列之间的相似度。

## Reference

- [波形匹配算法](https://wenku.baidu.com/view/db0e703bbd23482fb4daa58da0116c175e0e1e66.html)
- [波形匹配中互相关的一种新的快速算法](https://max.book118.com/html/2018/1022/6101034235001223.shtm)
- [How does Shazam work? Music Recognition Algorithms, Fingerprinting, and Processing](https://www.toptal.com/algorithms/shazam-it-music-processing-fingerprinting-and-recognition)

