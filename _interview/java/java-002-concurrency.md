---
title: "并发编程"
sequence: "102"
---

## 线程

- [ ] 创建线程有几种方式

## 线程池

- [ ] 创建
  - [ ] 为什么不建议使用 Executors 来创建线程池？ https://www.bilibili.com/video/BV1EN411e77V?p=2
- [ ] 线程池的实现原理
- [ ] 线程池的核心线程数和最大线程数如何设置
- [ ] 线程池中的线程有几种创建场景和销毁场景

- [ ] `synchronized` 与 `ReentrantLock` 之间的区别

## 线程池的种类

在 `java.util.concurrent` 中，提供了工具类 `Executors` （调度器）对象来创建线程池。

可创建的线程池有四种：

- CachedThreadPool 可缓存线程池
- FixedThreadPool 定长线程池
- SingleThreadExecutor 单线程池
- ScheduledThreadPool 调度线程池

## 线程安全

线程安全，其实不是“线程”的安全，而是“内存”的安全，或者“内存数据的一致性”。

如何实现：

- 规避
    - 使用局部变量  （位置隔离）
    - 使用 ThreadLocal （数据隔离）
    - 使用 final 对象
- 面对
    - 加锁
        - 悲观锁，互斥锁 (线程多的时候)
    - 不使用锁
        - 乐观锁，失败重试 （线程少的时候） CAS

## 如何识别死锁

可以使用 `jstack PID` 命令

- 互斥：共享资源只能被一个线程占用 —— 互斥锁
- 占有且等待：线程当前占有至少一个资源并还想请求其它线程持有的其它资源就会造成等待。——等待对方释放资源
- 不可抢占：资源只能由持有它的线程自愿释放，其它线程不可强行占有该资源。——无法释放对方资源
- 循环等待：线程 T1 等待线程 T2 占有的资源，线程 T2 等待线程 T1 占有的资源，就是循环等待 —— 两个线程互相等待
