---
title: "三高问题：高并发、高性能、高可用"
sequence: "101"
---

```text
高性能：自身
高并发：外在的请求多了
高可用：健康
```

- 高性能：优化算法的时间复杂度、让数据更接近计算节点（MySQL->内存）
- 高可用：做冗余的方案（除了这台机器，还有另一台机器）；本质上，就是用好几台机器来解决一台机器有可能出现问题的情况。
- 高并发：解决方法就是提高“系统的并发度”
    - 一个 CPU 跑好几个线程
    - 在机器上加 CPU，比如原来是 4 核，然后加到 8 核、16 核，这样单机的能力就更强
    - 如果单机承受不住了，就加更多的机器
    - 如果整个机房都加满了，那就加系统，南方一个系统，北方一个系统；亚洲做一个系统，北美做一个系统

高性能，可能只是增加人工成本；而高可用和高性能都会带来钱的增长。


互联网的原则：

- 边界成本：一台机器，1000 个用户，成本是 1 元，2000 个用户是 0.5 元，4000 个用户是 0.25 元；
- 基本可用：推荐算法，不要求 100% 准确，即使 50% 也行，或者随机出点内容也行，只要用户不要白屏，扛过了这波流量就行
- 最终一致：秒杀场景下，不需要将减库存、出库成功；只要第二天，看到货物发了，就行；在这一天的时间了，可能没有创建出库单，在中间的过程中是属于不一致的，但最终它会达到一致的状态

如果 QPS 是一万，如果变成 QPS 是 10 万，会出现什么问题呢？一般高并发的问题，涉及的问题比较广泛；
大家知道木桶原理，整个流量多了 10 倍，很考验应聘者他的知识储备。
面试者要说出系统的瓶颈，他一个需要知道系统存在哪些组件。
至少需要知道有负载均衡、知道有缓存、有数据库；

负载均衡有哪几种，有 4 层和 7 层的，4 层是什么原理，7 层是什么原理？

一个 redis 组件，它能扛多少的每秒并发量？

redis 和 数据库，它们两者的并发量差异有多少啊？为什么会有这个差异？

Redis 与 MySQL 的吞吐量取决于具体的测试环境和硬件配置，一般来说 Redis 的吞吐量高于 MySQL。
例如，根据官方文档的建议，Redis 单实例最大的吞吐量为 100k+ 操作/秒，而 MySQL 在压力测试下读写能力约为 5K/s、写能力为 3K/s。
Redis 是一个基于内存 hash 结构的缓存型数据库，其优势在于高速读写能力，由于其为基于内存的数据库所以存储数据量受限。
而 MySQL 是一个关系型数据库，数据存储在硬盘上，读写速度相对较慢，但可以存储海量数据。

CPU 访问一次内存 和 CPU 访问一次硬盘，它们之间性能差距在什么地方？

是不是一个有解决问题的思路的人？

- 对于执行类的人，要扛 10 倍的量，这个 10 的量，我到底怎么去解决？这是具备执行思维的人，给我分了个问题，我就开始去干
- 第二种是具备解决问题思路的人？他会去问你这个流量是什么时候来的？什么时间，什么原因，需要不需要即时处理？
  - 时间：持续的时间有多少，是几秒钟，还是持续一小时，还是 365 天，天天都这样？
  - 处理方式：所有的流量，是不是需要立即处理，并且给用户一个结果


在不扩机器的情况下，如何扛住 10 倍流量？
回答：

- 可以做算法上的优化、让数据更接近计算节点；
- 如果不能扩机器的话，看一看在本机上有没有做并发优化的可能性；
- 看一下具体的面对的业务场景，它对于可用性和一致性的要求，能不能做一些权衡的取舍



## Reference

- [架构师回答技术问题系列：不加机器如何扛住十倍流量](https://www.bilibili.com/video/BV1Du4y1k7WW/)
- [经典面试题，大厂几个巧妙的方案，复杂高并发系统缓存设计](https://www.bilibili.com/video/BV1zs4y1R79v/)
