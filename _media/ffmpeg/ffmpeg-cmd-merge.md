---
title: "合并文件"
sequence: "102"
---


使用FFmpeg合并视频文件和音频文件是一个常见的操作，可以通过几种不同的方法实现。这里介绍一种简单且常用的方法：使用`-i`选项指定输入文件，并使用`-codec copy`来直接复制音视频流而不重新编码，从而高效地将它们合并。

假设你有一个视频文件`video.mp4`和一个音频文件`audio.mp3`，你想把音频合并到视频中生成一个新的文件`output.mp4`。

### 方法一：使用`-i`选项直接合并

这是最直接的方法，适用于音频和视频的时间长度一致或你不需要对音频进行裁剪的情况。

```bash
ffmpeg -i video.mp4 -i audio.mp3 -codec copy -shortest output.mp4
```

```bash
ffmpeg -i a.mp4 -i b.mp4 -codec copy -shortest output.mp4
```

这里的参数解释如下：

- `-i video.mp4`: 指定第一个输入文件为视频文件。
- `-i audio.mp3`: 指定第二个输入文件为音频文件。
- `-codec copy`: 表示不重新编码音视频流，而是直接复制。
- `-shortest`: 使得输出文件的长度与较短的那个输入文件（视频或音频）相同。如果不加这个选项，如果音频比视频长，输出文件将会包含所有音频内容，可能会超出视频的播放时间。

### 方法二：使用滤镜（filter_complex）

如果你需要对音频或视频进行一些处理（比如调整音量、同步等），可以使用`filter_complex`。下面的例子展示了如何合并并确保音视频同步：

```bash
ffmpeg -i video.mp4 -i audio.mp3 -filter_complex "[0:v][1:a]concat=n=1:v=1:a=1[v][a]" -map "[v]" -map "[a]" output.mp4
```

但是，在大多数情况下，如果你只是想简单地合并音视频而不需要额外处理，第一种方法就足够了。

### 注意事项

- 如果你的音频和视频文件的时间长度不同，你需要决定是裁剪较长的部分还是填充较短的部分。`-shortest`参数会截断较长的媒体以匹配较短的媒体。
- 在某些情况下，特别是当输出格式不支持原始编解码器时，可能无法使用`-codec copy`。这时，FFmpeg会自动重新编码数据流。
- 确保安装了最新版本的FFmpeg，因为旧版本可能存在兼容性问题或者缺少某些功能。

通过上述命令，你可以轻松地将视频文件和音频文件合并成一个新的文件。根据实际需求选择合适的方法即可。
